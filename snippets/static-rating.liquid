{%- comment -%}
  Static Rating Snippet
  Generates a consistent rating (4.0-4.8) based on product ID

  Usage:
    Full stars: {% render 'static-rating', product: product %}
    Badge style: {% render 'static-rating', product: product, style: 'badge' %}
{%- endcomment -%}

{%- liquid
  assign rating_index = product.id | modulo: 9
  case rating_index
    when 0
      assign rating = '4.0'
    when 1
      assign rating = '4.1'
    when 2
      assign rating = '4.2'
    when 3
      assign rating = '4.3'
    when 4
      assign rating = '4.4'
    when 5
      assign rating = '4.5'
    when 6
      assign rating = '4.6'
    when 7
      assign rating = '4.7'
    when 8
      assign rating = '4.8'
  endcase
-%}

{%- if style == 'badge' -%}
  <div class="static-rating-badge">
    <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
    <span>{{ rating }}</span>
  </div>
  <style>
    .static-rating-badge {
      position: absolute;
      bottom: 16px;
      left: 4px;
      background: rgba(0, 0, 0, 0.7);
      color: #fff;
      padding: 4px 4px 4px 2px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 4px;
      z-index: 5;
    }
    .static-rating-badge svg {
      color: #f5a623;
    }
  </style>
{%- else -%}
  {%- liquid
    assign rating_num = rating | times: 1.0
    if rating_num >= 4.6
      assign full_stars = 5
      assign half_star = false
    elsif rating_num >= 4.3
      assign full_stars = 4
      assign half_star = true
    else
      assign full_stars = 4
      assign half_star = false
    endif
    assign empty_stars = 5 | minus: full_stars
    if half_star
      assign empty_stars = empty_stars | minus: 1
    endif
  -%}
  <div class="static-rating flex align-items-center flex-wrap">
    <div class="stars flex" style="color: #f5a623; font-size: 14px;">
      {%- for i in (1..full_stars) -%}
        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
      {%- endfor -%}
      {%- if half_star -%}
        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><defs><linearGradient id="half-{{ product.id }}"><stop offset="50%" stop-color="currentColor"/><stop offset="50%" stop-color="#d1d5db"/></linearGradient></defs><path fill="url(#half-{{ product.id }})" d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
      {%- endif -%}
      {%- for i in (1..empty_stars) -%}
        <svg width="14" height="14" viewBox="0 0 24 24" fill="#d1d5db"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
      {%- endfor -%}
    </div>
    <span class="rating-value ml-5" style="font-size: 13px; color: #666;">{{ rating }}</span>
    <span class="rating-caveat ml-5" style="font-size: 11px; color: #999;">(Based on reviews from leading marketplaces)</span>
  </div>
{%- endif -%}
