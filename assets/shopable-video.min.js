"use strict";import PhotoSwipeLightbox from"./photoswipe-lightbox.min.js";import PhotoSwipe from"./photoswipe.min.js";import PhotoSwipeVideoPlugin from"./bls.photoswipe-video.min.js";import PhotoSwipeDynamicCaption from"./photoswipe-dynamic-caption.min.js";var BlsWishlistHeader={init:function(){this.handleCount()},handleCount:function(){const t=document.querySelectorAll(".bls-header-wishlist"),e=JSON.parse(localStorage.getItem("bls__wishlist-items"));t.forEach(t=>{const i=t.querySelector(".wishlist-count");i&&(i.innerText=null!==e&&0!=e.length?e.length:0)})}},BlsWishlistLoad={init:function(t,e){const i=document.querySelector(".bls__wishlist-page-section");if(t){const s=[];if(null===e)s.push(t),localStorage.setItem("bls__wishlist-items",JSON.stringify(s));else{let o=e.indexOf(t);if(s.push(...e),-1===o)s.push(t),localStorage.setItem("bls__wishlist-items",JSON.stringify(s));else if(o>-1&&(s.splice(o,1),localStorage.setItem("bls__wishlist-items",JSON.stringify(s)),i)){const s=i.querySelector(".bls__wishlist-no-product-js"),o=document.querySelector('.bls__wishlist-list[data-product-handle="'+t+'"]');o&&o.remove();const r=i.querySelectorAll(".bls__product-item");(e.length<=1||r.length<1)&&s.classList.remove("d-none")}}BlsSubActionProduct.handleInitWishlist()}}},BlsSubActionProduct={init:function(){this.handleInitWishlist()},handleInitWishlist:function(){const t=JSON.parse(localStorage.getItem("bls__wishlist-items"));document.querySelectorAll(".bls__product-wishlist").forEach(e=>{const{proAddWishlist:i,proRemoveWishlist:s,removeWishlist:o,action:r}=e?.dataset,n=document.querySelector(".bls__wishlist-page-section"),a=e.querySelector(".bls_tooltip-content"),l=e.dataset.productHandle;null!==t&&(-1!==t.indexOf(l)?(e.querySelector(".bls__product-icon").classList.add("active"),a.innerText=n?window.stringsTemplate?.messageRemoveWishlist:"remove"===r?o:s):(e.querySelector(".bls__product-icon").classList.remove("active"),a.innerText=i)),BlsWishlistHeader.init()})}};BlsSubActionProduct.init();class ShopableWishlist extends HTMLElement{constructor(){super(),this.init()}init(){this.querySelector(".bls__product-wishlist-js").addEventListener("click",this.handleWishlistFunctionClick)}handleWishlistFunctionClick(t){t.preventDefault();const e=t.currentTarget,i=JSON.parse(localStorage.getItem("bls__wishlist-items")),s=e.dataset.productHandle,o=e.dataset.action,r=document.querySelector(".bls__wishlist-page-section");r&&BlsWishlistLoad.init(s,i);const n=[];if(null===i)n.push(s),localStorage.setItem("bls__wishlist-items",JSON.stringify(n)),BlsSubActionProduct.handleInitWishlist();else{let t=i.indexOf(s);n.push(...i),-1===t?(n.push(s),localStorage.setItem("bls__wishlist-items",JSON.stringify(n)),BlsSubActionProduct.handleInitWishlist()):t>-1&&(r?(n.splice(t,1),localStorage.setItem("bls__wishlist-items",JSON.stringify(n))):"remove"===o?BlsWishlistLoad.init(s,i):window.location.href=`${window.shopUrl}${window.Shopify.routes.root}pages/wishlist`)}}}customElements.define("shopable-wishlist",ShopableWishlist);class ButtonShowProduct extends HTMLElement{constructor(){super(),this.init()}init(){this.querySelector(".shopable-action").addEventListener("click",t=>{t.currentTarget.closest(".pswp__dynamic-caption").querySelector(".bls__product-shopable-video-item").classList.add("active")})}}customElements.define("button-show-product",ButtonShowProduct);class ShopableVideo extends HTMLElement{constructor(){super(),this.init()}init(){0!==Array.from(document.getElementsByClassName("bls__section_shopable-inner")).length&&this.openGallery()}generateUniqueId(){return Math.random().toString(36).substring(2,10)+Date.now().toString(36).substring(2,12)}replaceFunction(t){const e=t.querySelector("variant-radios-product-shopable-video"),i=e?.dataset.section,s=this.generateUniqueId(),o=i?.replace(i,s);o&&(t.querySelector("form").setAttribute("id",`product-form-${o}`),e.setAttribute("data-section",o))}openGallery(){const t=new PhotoSwipeLightbox({counter:!1,zoom:!1,preloader:!1,loop:!0,autoplay:!0,close:!1,mainClass:"pswp--shopable-video",arrowPrevSVG:'<i class="lnr lnr-chevron-left"></i>',arrowNextSVG:'<i class="lnr lnr-chevron-right"></i>',gallery:"#shopable-video-popup",children:".bls__section_shopable-inner",pswpModule:PhotoSwipe,bgOpacity:.5});t.on("uiRegister",function(){t.pswp.ui.registerElement({name:"bls--close",isButton:!0,tagName:"button",html:'<i class="lnr lnr-cross"></i>',onClick:()=>{t.pswp.close()}})}),t.on("bindEvents",e=>{const i=t.pswp;i.bg.addEventListener("click",()=>{i.close()})}),t.on("close",e=>{t.pswp,document.querySelector(".bls__product-shopable-video-item")&&document.querySelector(".bls__product-shopable-video-item").classList.contains("active")&&document.querySelector(".bls__product-shopable-video-item").classList.remove("active")}),t.on("afterInit",e=>{const{pswp:i}=t,s=i.currSlide.dynamicCaption.element;s&&this.replaceFunction(s)}),t.addFilter("placeholderSrc",(e,i)=>{const{pswp:s}=t,o=s.currSlide.dynamicCaption.element;let r;return o&&(r=o.querySelector(".shopable-popup-action").dataset.msrc),r}),new PhotoSwipeDynamicCaption(t,{type:"auto"}),new PhotoSwipeVideoPlugin(t,{}),t.on("change",()=>{const{pswp:e}=t,i=e.currSlide.dynamicCaption.element;i&&this.replaceFunction(i)}),t.on("pointerDown",t=>{"swiper-slide"===t.originalEvent.target.className&&t.stopPropagation(),t.preventDefault()}),t.init()}}customElements.define("shopable-video",ShopableVideo);class VariantRadiosProductShopableVideo extends HTMLElement{constructor(){super(),this.querySelectorAll(".bls__option-swatch").forEach(t=>t.addEventListener("click",this.onVariantChange.bind(this),!1)),this.actionDropdownSwatches()}onVariantChange(t){t.preventDefault();const e=t.currentTarget,i=e.getAttribute("data-value");for(var s of e.closest("fieldset").querySelectorAll(".bls__option-swatch"))s.classList.remove("active");e.classList.toggle("active"),e.closest("fieldset").querySelector(".swatch-selected-value").textContent=i,this.options=Array.from(this.querySelectorAll(".bls__option-swatch.active"),t=>t.getAttribute("data-value")),this.updateMasterId(),this.toggleAddButton(!0,"",!1),this.updateVariantStatuses(),this.currentVariant?(this.updateVariantInput(),this.renderProductInfo()):(this.toggleAddButton(!0,"",!0),this.setUnavailable())}updateMasterId(){this.currentVariant=this.getVariantData().find(t=>!t.options.map((t,e)=>this.options[e]===t).includes(!1))}updateVariantInput(){document.querySelectorAll(`#product-form-${this.dataset.section}`).forEach(t=>{const e=t.querySelector('input[name="id"]');e.value=this.currentVariant.id,e.dispatchEvent(new Event("change",{bubbles:!0}))})}renderProductInfo(){if(!this.currentVariant)return;let t=0,e=0,i=!1,s=!1,o=!1,r=window.variantStrings.inStock,n=window.variantStrings.soldOut;const a=this.currentVariant.compare_at_price,l=this.currentVariant.price,c=document.getElementById(`product-form-${this.dataset.section}`).closest(".bls__product-shopable-video-item-popup");this.getVariantQtyData().find(e=>{e.id===this.currentVariant.id&&(t=e.qty)}),a&&a>l&&(i=!0,e=(a-l)/a*100),this.currentVariant.available&&t<1?(r=window.variantStrings.preOrder,n=window.variantStrings.preOrder):this.currentVariant.available?(r=window.variantStrings.inStock,n=window.variantStrings.addToCart):r=window.variantStrings.outStock,this.currentVariant.available&&t<1?o=!0:this.currentVariant.available||(s=!0),null===this.currentVariant.inventory_management&&(s=!1,o=!1,r=window.variantStrings.inStock,n=window.variantStrings.addToCart);const d=c.querySelector(".bls__product-label");if(d&&d.remove(),i||o||s){var u=document.createElement("div");u.classList.add("bls__product-label","fs-12","pointer-events-none","d-inline-block"),c.querySelector(".bls__product-details").insertBefore(u,c.querySelector(".bls__product-details").children[0]);const t=c.querySelector(".bls__product-label");if(s){var p=document.createElement("div");p.classList.add("bls__sold-out-label"),p.innerText=window.variantStrings.soldOut,t.appendChild(p)}else{if(i&&0==s){var h=document.createElement("div");h.classList.add("bls__sale-label"),h.innerText=-e.toFixed(0)+"%",t.appendChild(h)}if(o){var m=document.createElement("div");m.classList.add("bls__pre-order-label"),m.innerText=window.variantStrings.preOrder,t.appendChild(m)}}}const b=c.querySelectorAll(".product-notify-stock");b.length&&b.forEach(t=>{this.currentVariant.available?(t.style.display="none",t.setAttribute("data-product-variant",this.currentVariant.id)):(t.style.display="block",t.setAttribute("data-product-variant",this.currentVariant.id))});const S=Shopify.formatMoney(this.currentVariant.price,cartStrings.money_format);c.querySelector(".price__regular.price").innerHTML=S;const _=c.querySelector(".bls__price");if(_.classList.remove("price--sold-out","price--on-sale"),_.querySelector(".price__regular.price").classList.remove("special-price"),a&&a>l){const t=Shopify.formatMoney(a,cartStrings.money_format);_.querySelector(".compare-price")&&(_.querySelector(".compare-price").innerHTML=t),_.classList.add("price--on-sale"),_.querySelector(".price__regular.price").classList.add("special-price")}else this.currentVariant.available||_.classList.add("price--sold-out");this.toggleAddButton(!this.currentVariant.available,n)}toggleAddButton(t=!0,e,i=!0){const s=document.getElementById(`product-form-${this.dataset.section}`);if(!s)return;const o=s.querySelector('[name="add"]'),r=s.querySelector('[name="add"] > span'),n=s.querySelector(".bls__product-dynamic-checkout");o&&(t?(n&&(n.style.display="none"),o.setAttribute("disabled","disabled")):(n&&(n.style.display="block"),o.removeAttribute("disabled")),e&&(r.textContent=e))}updateVariantStatuses(){const t=this.getVariantData().filter(t=>this.querySelector(".active").dataset.value===t.option1),e=[...this.querySelectorAll(".product-form__input")];e.forEach((i,s)=>{if(0===s)return;const o=[...i.querySelectorAll(".bls__option-swatch")],r=e[s-1].querySelector(".active").dataset.value,n=t.filter(t=>t.available&&t[`option${s}`]===r).map(t=>t[`option${s+1}`]);this.setAvailability(o,n)})}setAvailability(t,e){t.forEach(t=>{e.includes(t.dataset.value)?t.removeAttribute("data-disabled"):t.setAttribute("data-disabled","disable")})}setUnavailable(){const t=document.getElementById(`product-form-${this.dataset.section}`),e=t.querySelector('[name="add"]'),i=t.querySelector('[name="add"] > span'),s=document.getElementById(`price-${this.dataset.section}`);e&&(i.textContent=window.variantStrings.unavailable,s&&s.classList.add("visibility-hidden"))}getVariantData(){return this.variantData=this.variantData||JSON.parse(this.querySelector('[type="application/json"]').textContent),this.variantData}getVariantQtyData(){return this.variantQtyData=JSON.parse(this.querySelector(".productVariantsQty").textContent),this.variantQtyData}eventProductGroupAction(){document.querySelectorAll("#bls__product-group .product-variant-option").forEach(t=>{t.addEventListener("change",t=>{var e=t.target,i=e.options[e.selectedIndex].getAttribute("data-image"),s=e.getAttribute("data-handle"),o=e.closest("#bls__product-group").querySelector(".product-group-image-item."+s).querySelector("img");o&&(o.removeAttribute("srcset"),o.setAttribute("src",i))},!1)}),document.querySelectorAll(".product-group-submit").forEach(t=>{t.addEventListener("click",this.submitProductGroup.bind(this),!1)})}submitProductGroup(t){t.preventDefault();const e=t.currentTarget,i=document.querySelector("cart-notification")||document.querySelector("cart-drawer"),s=document.getElementById("bls__product-group-form"),o=fetchConfig("json");o.headers["X-Requested-With"]="XMLHttpRequest",delete o.headers["Content-Type"];const r=new FormData(s);Object.fromEntries(r.entries()),i&&(r.append("sections",i.getSectionsToRender().map(t=>t.id)),r.append("sections_url",window.location.pathname)),o.body=r,e.classList.add("btn-loading"),fetch(`${routes.cart_add_url}.js`,o).then(t=>t.text()).then(t=>{fetch("/cart.json").then(t=>t.json()).then(t=>{document.querySelectorAll(".cart-count").forEach(e=>{e.classList.contains("cart-count-drawer")?e.innerHTML=`(${t.item_count})`:e.innerHTML=t.item_count});const e=document.querySelector("free-ship-progress-bar");e&&e.init(t.items_subtotal_price)}).catch(t=>{throw t});const e=JSON.parse(t);i.getSectionsToRender().forEach(t=>{const s=document.getElementById(t.id),o=(new DOMParser).parseFromString(e.sections[t.id],"text/html");s.innerHTML=o.querySelector("#form-mini-cart").innerHTML;const r=i.querySelector(".cart-countdown-time"),n=o.querySelector(".cart-countdown-time");r&&n&&(r.innerHTML=n.innerHTML,i.countdownTimer())}),i.cartAction()}).catch(t=>{throw t}).finally(()=>{e.classList.remove("btn-loading"),i.open(),BlsLazyloadImg.init()})}actionDropdownSwatches(){this.querySelectorAll("[data-swatches-value]").forEach(t=>{t.addEventListener("click",t=>{const e=t.currentTarget;if(e.closest(".bls__color-dropdown").classList.contains("isClicked"))e.closest(".bls__color-dropdown").classList.remove("isClicked");else{for(var i of document.querySelectorAll(".bls__color-dropdown"))i.classList.remove("isClicked");e.closest(".bls__color-dropdown").classList.add("isClicked")}},!1)}),this.querySelectorAll(".bls__product-color-swatches-dropdown").forEach(t=>{t.addEventListener("click",t=>{const e=t.currentTarget,i=e.dataset.value;e.closest(".bls__color-dropdown").querySelector(".bls__color-dropdown-action .bls__color-dropdown-value").innerHTML=i,e.closest(".bls__color-dropdown").classList.remove("isClicked")})})}}customElements.define("variant-radios-product-shopable-video",VariantRadiosProductShopableVideo);