class VariantRadiosProductSingle extends HTMLElement{constructor(){super(),this.querySelectorAll(".bls__option-swatch").forEach(t=>t.addEventListener("click",this.onVariantChange.bind(this),!1)),this.actionDropdownSwatches()}onVariantChange(t){t.preventDefault();const e=t.currentTarget,r=e.getAttribute("data-value");for(var o of e.closest("fieldset").querySelectorAll(".bls__option-swatch"))o.classList.remove("active");e.classList.toggle("active"),e.closest("fieldset").querySelector(".swatch-selected-value").textContent=r,this.options=Array.from(this.querySelectorAll(".bls__option-swatch.active"),t=>t.getAttribute("data-value")),this.updateMasterId(),this.toggleAddButton(!0,"",!1),this.updateVariantStatuses(),this.currentVariant?(this.updateVariantInput(),this.renderProductInfo()):(this.toggleAddButton(!0,"",!0),this.setUnavailable())}updateMasterId(){this.currentVariant=this.getVariantData().find(t=>!t.options.map((t,e)=>this.options[e]===t).includes(!1))}updateVariantInput(){document.querySelectorAll(`#product-form-${this.dataset.section}`).forEach(t=>{const e=t.querySelector('input[name="id"]');e.value=this.currentVariant.id,e.dispatchEvent(new Event("change",{bubbles:!0}))})}renderProductInfo(){if(!this.currentVariant)return;let t=0,e=0,r=!1,o=!1,a=!1,i=window.variantStrings.inStock,n=window.variantStrings.soldOut;const c=this.currentVariant.compare_at_price,s=this.currentVariant.price,l=document.getElementById(`product-form-${this.dataset.section}`).closest(".bls__product-single");this.getVariantQtyData().find(e=>{e.id===this.currentVariant.id&&(t=e.qty)}),c&&c>s&&(r=!0,e=(c-s)/c*100),this.currentVariant.available&&t<1?(i=window.variantStrings.preOrder,n=window.variantStrings.preOrder):this.currentVariant.available?(i=window.variantStrings.inStock,n=window.variantStrings.addToCart):i=window.variantStrings.outStock,l.querySelector(".bls__availability-value")&&(l.querySelector(".bls__availability-value").textContent=i),this.currentVariant.available&&t<1?a=!0:this.currentVariant.available||(o=!0),null===this.currentVariant.inventory_management&&(o=!1,a=!1,i=window.variantStrings.inStock,n=window.variantStrings.addToCart);const d=l.querySelector(".bls__product-label");if(d&&d.remove(),r||a||o){var u=document.createElement("div");u.classList.add("bls__product-label","fs-12","pointer-events-none","absolute"),l.querySelector(".bls__product-details").insertBefore(u,l.querySelector(".bls__product-details").children[0]);const t=l.querySelector(".bls__product-label");if(o){var p=document.createElement("div");p.classList.add("bls__sold-out-label"),p.innerText=window.variantStrings.soldOut,t.appendChild(p)}else{if(r&&0==o){var h=document.createElement("div");h.classList.add("bls__sale-label"),"price"==window.productLabel.saleType?h.innerText="- "+Shopify.formatMoney(c-s,cartStrings.money_format):"text"==window.productLabel.saleType?h.innerText=window.productLabel.saleLabel:h.innerText=-e.toFixed(0)+"%",t.appendChild(h)}if(a){var m=document.createElement("div");m.classList.add("bls__pre-order-label"),m.innerText=window.variantStrings.preOrder,t.appendChild(m)}}}const y=l.querySelectorAll(".product-notify-stock");y.length&&y.forEach(t=>{this.currentVariant.available?(t.style.display="none",t.setAttribute("data-product-variant",this.currentVariant.id)):(t.style.display="block",t.setAttribute("data-product-variant",this.currentVariant.id))}),this.currentVariant.featured_media&&setTimeout(()=>{l.querySelector(".bls__product-main-img img").removeAttribute("srcset"),l.querySelector(".bls__product-main-img img").setAttribute("src",this.currentVariant.featured_media.preview_image.src)},500),l.querySelector(".bls__product-sku-value")&&(l.querySelector(".bls__product-sku-value").textContent=this.currentVariant.sku&&""!=this.currentVariant.sku?this.currentVariant.sku:"N/A");const g=Shopify.formatMoney(this.currentVariant.price,cartStrings.money_format);l.querySelector(".price__regular.price").innerHTML=g;const f=l.querySelector(".bls__price");if(f.classList.remove("price--sold-out","price--on-sale"),f.querySelector(".price__regular.price").classList.remove("special-price"),c&&c>s){const t=Shopify.formatMoney(c,cartStrings.money_format);f.querySelector(".compare-price")&&(f.querySelector(".compare-price").innerHTML=t),f.classList.add("price--on-sale"),f.querySelector(".price__regular.price").classList.add("special-price")}else this.currentVariant.available||f.classList.add("price--sold-out");this.toggleAddButton(!this.currentVariant.available,n)}toggleAddButton(t=!0,e,r=!0){const o=document.getElementById(`product-form-${this.dataset.section}`);if(!o)return;const a=o.querySelector('[name="add"]'),i=o.querySelector('[name="add"] > span'),n=o.querySelector(".bls__product-dynamic-checkout");a&&(t?(n&&(n.style.display="none"),a.setAttribute("disabled","disabled")):(n&&(n.style.display="block"),a.removeAttribute("disabled")),e&&(i.textContent=e))}updateVariantStatuses(){const t=this.getVariantData().filter(t=>this.querySelector(".active").dataset.value===t.option1),e=[...this.querySelectorAll(".product-form__input")];e.forEach((r,o)=>{if(0===o)return;const a=[...r.querySelectorAll(".bls__option-swatch")],i=e[o-1].querySelector(".active").dataset.value,n=t.filter(t=>t.available&&t[`option${o}`]===i).map(t=>t[`option${o+1}`]);this.setAvailability(a,n)})}setAvailability(t,e){t.forEach(t=>{e.includes(t.dataset.value)?t.removeAttribute("data-disabled"):t.setAttribute("data-disabled","disable")})}setUnavailable(){const t=document.getElementById(`product-form-${this.dataset.section}`),e=t.querySelector('[name="add"]'),r=t.querySelector('[name="add"] > span'),o=document.getElementById(`price-${this.dataset.section}`);e&&(r.textContent=window.variantStrings.unavailable,o&&o.classList.add("visibility-hidden"))}getVariantData(){return this.variantData=this.variantData||JSON.parse(this.querySelector('[type="application/json"]').textContent),this.variantData}getVariantQtyData(){return this.variantQtyData=JSON.parse(this.querySelector(".productVariantsQty").textContent),this.variantQtyData}eventProductGroupAction(){document.querySelectorAll("#bls__product-group .product-variant-option").forEach(t=>{t.addEventListener("change",t=>{var e=t.target,r=e.options[e.selectedIndex].getAttribute("data-image"),o=e.getAttribute("data-handle"),a=e.closest("#bls__product-group").querySelector(".product-group-image-item."+o).querySelector("img");a&&(a.removeAttribute("srcset"),a.setAttribute("src",r))},!1)}),document.querySelectorAll(".product-group-submit").forEach(t=>{t.addEventListener("click",this.submitProductGroup.bind(this),!1)})}submitProductGroup(t){t.preventDefault();const e=t.currentTarget,r=document.querySelector("cart-notification")||document.querySelector("cart-drawer"),o=document.getElementById("bls__product-group-form"),a=fetchConfig("json");a.headers["X-Requested-With"]="XMLHttpRequest",delete a.headers["Content-Type"];const i=new FormData(o);Object.fromEntries(i.entries()),r&&(i.append("sections",r.getSectionsToRender().map(t=>t.id)),i.append("sections_url",window.location.pathname)),a.body=i,e.classList.add("btn-loading"),fetch(`${routes.cart_add_url}.js`,a).then(t=>t.text()).then(t=>{fetch("/cart.json").then(t=>t.json()).then(t=>{document.querySelectorAll(".cart-count").forEach(e=>{e.classList.contains("cart-count-drawer")?e.innerHTML=`(${t.item_count})`:e.innerHTML=t.item_count});const e=document.querySelector("free-ship-progress-bar");e&&e.init(t.items_subtotal_price)}).catch(t=>{throw t});const e=JSON.parse(t);r.getSectionsToRender().forEach(t=>{const o=document.getElementById(t.id),a=(new DOMParser).parseFromString(e.sections[t.id],"text/html");o.innerHTML=a.querySelector("#form-mini-cart").innerHTML;const i=r.querySelector(".cart-countdown-time"),n=a.querySelector(".cart-countdown-time");i&&n&&(i.innerHTML=n.innerHTML,r.countdownTimer())}),r.cartAction()}).catch(t=>{throw t}).finally(()=>{e.classList.remove("btn-loading"),r.open(),BlsLazyloadImg.init()})}actionDropdownSwatches(){this.querySelectorAll("[data-swatches-value]").forEach(t=>{t.addEventListener("click",t=>{const e=t.currentTarget;if(e.closest(".bls__color-dropdown").classList.contains("isClicked"))e.closest(".bls__color-dropdown").classList.remove("isClicked");else{for(var r of document.querySelectorAll(".bls__color-dropdown"))r.classList.remove("isClicked");e.closest(".bls__color-dropdown").classList.add("isClicked")}},!1)}),this.querySelectorAll(".bls__product-color-swatches-dropdown").forEach(t=>{t.addEventListener("click",t=>{const e=t.currentTarget,r=e.dataset.value;e.closest(".bls__color-dropdown").querySelector(".bls__color-dropdown-action .bls__color-dropdown-value").innerHTML=r,e.closest(".bls__color-dropdown").classList.remove("isClicked")})})}}customElements.define("variant-radios-product-single",VariantRadiosProductSingle);var BlsEventGroup={init:function(){this.eventProductGroup(),this.showPopupStockNotify()},eventProductGroup:function(){var t=document.querySelector('.productGroup[type="application/json"]');if(t){var e=JSON.parse(t.innerText),r="";e.forEach((t,e,o)=>{Object.is(o.length-1,e)?r+=t:r+=t+"%20OR%20id:"});var o="?q=id:"+r+"&section_id=product-grouped";fetch(`${window.routes.search_url}${o}`).then(t=>t.text()).then(async t=>{const e=(new DOMParser).parseFromString(t,"text/html");document.getElementById("bls__product-group").innerHTML=e.querySelector(".bls__product-group").innerHTML}).catch(t=>{throw error}).finally(()=>{this.eventProductGroupAction(),BlsLazyloadImg.init()})}},eventProductGroupAction:function(){document.querySelectorAll("#bls__product-group .product-variant-option").forEach(t=>{t.addEventListener("change",t=>{var e=t.target,r=e.options[e.selectedIndex].getAttribute("data-image"),o=e.options[e.selectedIndex].getAttribute("data-price"),a=e.getAttribute("data-handle"),i=e.options[e.selectedIndex].getAttribute("data-compare-price"),n=e.closest("#bls__product-group").querySelector(".product-group-image-item."+a).querySelector("img");n&&(n.removeAttribute("srcset"),n.setAttribute("src",r));var c=e.closest(".product-group-item").querySelector(".info-price");c.querySelector(".price__regular.price").innerHTML=Shopify.formatMoney(o,cartStrings.money_format);const s=c.querySelector(".bls__price");if(s.classList.remove("price--sold-out","price--on-sale"),s.querySelector(".price__regular.price").classList.remove("special-price"),i&&i>o){const t=Shopify.formatMoney(i,cartStrings.money_format);s.querySelector(".compare-price")&&(s.querySelector(".compare-price").innerHTML=t),s.classList.add("price--on-sale"),s.querySelector(".price__regular.price").classList.add("special-price")}e.setAttribute("data-price",o),e.setAttribute("data-compare-price",i)},!1)});let t=0;const e=document.querySelectorAll(".quantity__input-product-group");e.forEach(r=>{let o=r.value,a=parseFloat(o);isNaN(a)||(t+=a),r.addEventListener("change",()=>{t=0,e.forEach(e=>{let r=e.value,o=parseFloat(r);isNaN(o)||(t+=o)})})}),document.querySelectorAll(".product-group-submit").forEach(e=>{e.addEventListener("click",r=>{if(0===t){const t=document.querySelector(".form-infor .add-cart-error"),r=e.getAttribute("data-add-cart-err-qty");if(!t)return;var o=EasyDialogBox.create("add_cart_error","dlg dlg-disable-footer dlg-disable-drag dlg-disable-heading","",t.innerHTML=r);o.onClose=o.destroy,o.show()}else this.submitProductGroup(r)},!1)}),document.querySelectorAll(".product-group-buy-now").forEach(e=>{e.addEventListener("click",r=>{if(0===t){const t=document.querySelector(".form-infor .add-cart-error"),r=e.getAttribute("data-add-cart-err-qty");if(!t)return;var o=EasyDialogBox.create("add_cart_error","dlg dlg-disable-footer dlg-disable-drag dlg-disable-heading","",t.innerHTML=r);o.onClose=o.destroy,o.show()}else this.submitNowProductGroup(r)},!1)})},submitProductGroup:function(t){t.preventDefault();const e=t.currentTarget,r=document.querySelector("cart-notification")||document.querySelector("cart-drawer"),o=document.getElementById("form-product-grouped"),a=fetchConfig("json");a.headers["X-Requested-With"]="XMLHttpRequest",delete a.headers["Content-Type"];let i=0;const n=new FormData(o);r&&(n.append("sections",r.getSectionsToRender().map(t=>t.id)),n.append("sections_url",window.location.pathname)),a.body=n,e.classList.add("btn-loading"),fetch(`${routes.cart_add_url}.js`,a).then(t=>t.text()).then(t=>{fetch("/cart.json").then(t=>t.json()).then(t=>{document.querySelectorAll(".cart-count").forEach(e=>{e.classList.contains("cart-count-drawer")?e.innerHTML=`(${t.item_count})`:e.innerHTML=t.item_count});const e=document.querySelector("free-ship-progress-bar");e&&e.init(t.items_subtotal_price)}).catch(t=>{throw t});const e=JSON.parse(t);if(e.message){const t=document.querySelector(".form-infor .add-cart-error");if(!t)return;var o=EasyDialogBox.create("add_cart_error","dlg dlg-disable-footer dlg-disable-drag dlg-disable-heading","",t.innerHTML=e.description);o.onClose=o.destroy,o.show()}else i=1,r.getSectionsToRender().forEach(t=>{const o=document.getElementById(t.id),a=(new DOMParser).parseFromString(e.sections[t.id],"text/html");o.innerHTML=a.querySelector("#form-mini-cart").innerHTML;const i=r.querySelector(".cart-countdown-time"),n=a.querySelector(".cart-countdown-time");i&&n&&(i.innerHTML=n.innerHTML,r.countdownTimer())}),r.cartAction()}).catch(t=>{throw t}).finally(()=>{e.classList.remove("btn-loading"),1===i&&r.open(),BlsLazyloadImg.init()})},submitNowProductGroup:function(t){t.preventDefault();const e=document.getElementById("form-product-grouped"),r=fetchConfig("json");r.headers["X-Requested-With"]="XMLHttpRequest",delete r.headers["Content-Type"];const o=new FormData(e);r.body=o,fetch(`${routes.cart_add_url}.js`,r).then(t=>t.text()).then(t=>{const e=JSON.parse(t);if(e.items)window.location.href="/checkout";else{const t=document.querySelector(".form-infor .add-cart-error");if(!t)return;var r=EasyDialogBox.create("add_cart_error","dlg dlg-disable-footer dlg-disable-drag dlg-disable-heading","",t.innerHTML=e.description);r.onClose=r.destroy,r.show()}}).catch(t=>{throw t})},showPopupStockNotify:function(){const t=document.querySelectorAll(".product-notify-stock"),e=this;t.forEach(t=>{t.addEventListener("click",t=>{const r=t.currentTarget.getAttribute("data-product-variant");t.preventDefault(),e.fetchDataStockNotifySection(r)})})},fetchDataStockNotifySection:function(t){fetch("/variants/"+t+"/?section_id=stock-notify").then(t=>t.text()).then(t=>{const e=newParser.parseFromString(t,"text/html").querySelector("#bls-stock-notify"),r=e.getAttribute("data-stock-title");if(e){var o=EasyDialogBox.create("stockNotify","dlg dlg-disable-footer dlg-disable-drag",r,e.innerHTML);o.onClose=o.destroy,o.show()}}).catch(t=>{throw t})}};BlsEventGroup.init();